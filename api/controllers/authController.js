const { supabase } = require('../config/supabase');\nconst { AppError } = require('../middleware/errorHandler');\nconst { asyncHandler } = require('../middleware/errorHandler');\nconst logger = require('../utils/logger');\n\n// Get current user profile\nconst getCurrentUser = asyncHandler(async (req, res) => {\n  try {\n    // Get profile data\n    const { data: profile, error } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', req.user.id)\n      .single();\n\n    const userData = {\n      id: req.user.id,\n      email: req.user.email,\n      firstName: profile?.first_name || '',\n      lastName: profile?.last_name || ''\n    };\n\n    res.json({ \n      success: true,\n      user: userData \n    });\n  } catch (error) {\n    logger.error('Get user error:', error);\n    throw new AppError('Failed to get user data', 500);\n  }\n});\n\n// Update user profile\nconst updateProfile = asyncHandler(async (req, res) => {\n  const { firstName, lastName } = req.body;\n  \n  try {\n    const { data, error } = await supabase\n      .from('profiles')\n      .upsert({\n        id: req.user.id,\n        first_name: firstName,\n        last_name: lastName,\n        updated_at: new Date().toISOString()\n      })\n      .select()\n      .single();\n\n    if (error) {\n      throw error;\n    }\n\n    res.json({\n      success: true,\n      message: 'Profile updated successfully',\n      user: {\n        id: req.user.id,\n        email: req.user.email,\n        firstName: data.first_name,\n        lastName: data.last_name\n      }\n    });\n  } catch (error) {\n    logger.error('Update profile error:', error);\n    throw new AppError('Failed to update profile', 500);\n  }\n});\n\nmodule.exports = {\n  getCurrentUser,\n  updateProfile\n};